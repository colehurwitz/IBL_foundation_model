# This file contains the implementation of the r2 score metric
from torcheval.metrics import R2Score
import torch

r2_metric = R2Score()
def r2_score(y_true, y_pred, device="cpu"):
    r2_metric.reset()
    r2_metric.to(device)
    y_true = y_true.to(device)
    y_pred = y_pred.to(device)
    r2_metric.update(y_pred, y_true)
    
    return r2_metric.compute().item()
